<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Asset Finder (Aktien & Krypto)</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#0f172a;
    color:#e5e7eb;
    padding:20px;
}
select,button{
    padding:10px;
    margin-top:10px;
    width:100%;
}
#box{
    background:#020617;
    padding:20px;
    border-radius:10px;
    max-width:500px;
    margin:auto;
}
.progress{
    height:10px;
    background:#1e293b;
    border-radius:5px;
    overflow:hidden;
    margin-top:10px;
}
.progress div{
    height:100%;
    width:0%;
    background:#38bdf8;
}
.small{font-size:12px;opacity:.8}
</style>
</head>

<body>
<div id="box">
<h2>üìä Asset-Scanner</h2>

<div id="status">Starte Suche‚Ä¶</div>
<div class="progress"><div id="bar"></div></div>
<div class="small" id="counter">Gepr√ºft: 0 | Gefunden: 0</div>
<div class="small" id="eta">ETA: ‚Äì</div>

<select id="assetSelect">
<option>Lade Assets‚Ä¶</option>
</select>

<button onclick="openTradingView()">üìà TradingView √∂ffnen</button>
</div>

<script>
/* =====================
   KONFIGURATION
===================== */
const FINNHUB_API_KEY = "DEIN_API_KEY_HIER";
const MIN_DAYS = 10;
const TARGET_COUNT = 10;
const DELAY = 1200;

/* =====================
   STATE
===================== */
let found = [];
let checked = 0;
let startTime = Date.now();
let running = true;

const assetSelect = document.getElementById("assetSelect");

/* =====================
   ASSET LISTEN
===================== */

// SICHERE US-AKTIEN (funktionieren bei Finnhub)
const STOCKS = [
 {symbol:"AAPL",name:"Apple Inc."},
 {symbol:"MSFT",name:"Microsoft Corporation"},
 {symbol:"AMZN",name:"Amazon.com Inc."},
 {symbol:"GOOGL",name:"Alphabet Inc. Class A"},
 {symbol:"META",name:"Meta Platforms Inc."},
 {symbol:"NVDA",name:"NVIDIA Corporation"},
 {symbol:"TSLA",name:"Tesla Inc."},
 {symbol:"JPM",name:"JPMorgan Chase & Co."},
 {symbol:"V",name:"Visa Inc."},
 {symbol:"WMT",name:"Walmart Inc."}
];

// KRYPTO (Binance ‚Äì immer verf√ºgbar)
const CRYPTOS = [
 {symbol:"BTCUSDT",name:"Bitcoin"},
 {symbol:"ETHUSDT",name:"Ethereum"},
 {symbol:"BNBUSDT",name:"BNB"},
 {symbol:"SOLUSDT",name:"Solana"},
 {symbol:"XRPUSDT",name:"XRP"}
];

const ALL = [...STOCKS.map(s=>({...s,type:"stock"})),
             ...CRYPTOS.map(c=>({...c,type:"crypto"}))];
/* =====================
   HELFER
===================== */
const sleep = ms => new Promise(r=>setTimeout(r,ms));

function setStatus(t){document.getElementById("status").textContent=t}
function updateUI(){
 document.getElementById("counter").textContent =
  `Gepr√ºft: ${checked} | Gefunden: ${found.length}`;
 document.getElementById("bar").style.width =
  Math.min(100,(found.length/TARGET_COUNT)*100)+"%";

 const elapsed=(Date.now()-startTime)/1000;
 const avg=checked?elapsed/checked:0;
 const eta=Math.max((TARGET_COUNT-found.length)*avg,0);
 document.getElementById("eta").textContent=
  `ETA: ca. ${Math.ceil(eta)}s`;
}

/* =====================
   HISTORIE CHECK
===================== */
async function stockHistory(sym){
 const to=Math.floor(Date.now()/1000);
 const from=to-MIN_DAYS*86400;
 const r=await fetch(
  `https://finnhub.io/api/v1/stock/candle?symbol=${sym}&resolution=D&from=${from}&to=${to}&token=${FINNHUB_API_KEY}`
 );
 const d=await r.json();
 return d.s==="ok" && d.c?.length>=MIN_DAYS;
}

async function cryptoHistory(sym){
 const r=await fetch(
  `https://api.binance.com/api/v3/klines?symbol=${sym}&interval=1d&limit=${MIN_DAYS}`
 );
 const d=await r.json();
 return Array.isArray(d) && d.length>=MIN_DAYS;
}

/* =====================
   SUCHE
===================== */
async function run(){
 assetSelect.innerHTML="";
 setStatus("üîç Suche Assets‚Ä¶");

 for(const a of ALL){
  if(!running||found.length>=TARGET_COUNT)break;

  checked++;
  try{
   const ok = a.type==="stock"
    ? await stockHistory(a.symbol)
    : await cryptoHistory(a.symbol);

   if(ok){
    found.push(a);
    const o=document.createElement("option");
    o.value=a.symbol;
    o.textContent=`${a.name} (${a.type})`;
    assetSelect.appendChild(o);
   }
  }catch{}
  updateUI();
  await sleep(DELAY);
 }

 setStatus(found.length
  ? "‚úÖ Assets gefunden"
  : "‚ùå Keine Assets gefunden");
}

function openTradingView(){
 const o=assetSelect.selectedOptions[0];
 if(!o)return;
 const txt=o.textContent.includes("crypto")
  ? `BINANCE:${assetSelect.value}`
  : `NASDAQ:${assetSelect.value}`;
 window.open(`https://www.tradingview.com/chart/?symbol=${txt}`,"_blank");
}

run();
</script>
</body>
</html>
